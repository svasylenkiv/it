# –©–æ–± –¥–æ–∑–≤–æ–ª–∏—Ç–∏ RDP (Remote Desktop Protocol) —É PowerShell –Ω–∞ Windows, –≤–∏–∫–æ–Ω–∞–π —Ü—ñ –∫–æ–º–∞–Ω–¥–∏ –≤—ñ–¥ —ñ–º–µ–Ω—ñ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞:

![RDP](images/rdp.png)
### ‚úÖ 1. –£–≤—ñ–º–∫–Ω—É—Ç–∏ RDP-—Å–ª—É–∂–±—É
```powershell
Set-ItemProperty -Path 'HKLM:\System\CurrentControlSet\Control\Terminal Server' -Name "fDenyTSConnections" -Value 0
```

### ‚úÖ 2. –î–æ–∑–≤–æ–ª–∏—Ç–∏ RDP —á–µ—Ä–µ–∑ –±—Ä–∞–Ω–¥–º–∞—É–µ—Ä Windows
```powershell
Enable-NetFirewallRule -DisplayGroup "Remote Desktop"
```

### ‚úÖ 3. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ –¥–æ–∑–≤–æ–ª–µ–Ω–æ
```powershell
(Get-ItemProperty -Path 'HKLM:\System\CurrentControlSet\Control\Terminal Server').fDenyTSConnections
```

–ú–∞—î –±—É—Ç–∏ 0 ‚Äî –æ–∑–Ω–∞—á–∞—î, —â–æ RDP —É–≤—ñ–º–∫–Ω–µ–Ω–æ.

## üîí (–ù–µ–æ–±–æ–≤‚Äô—è–∑–∫–æ–≤–æ) –î–æ–∑–≤–æ–ª–∏—Ç–∏ –ª–∏—à–µ –¥–ª—è –ø–µ–≤–Ω–æ–≥–æ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É –∞–±–æ IP. –î–ª—è –ø—ñ–¥–≤–∏—â–µ–Ω–Ω—è –±–µ–∑–ø–µ–∫–∏ –º–æ–∂–Ω–∞ –æ–±–º–µ–∂–∏—Ç–∏ –¥–æ—Å—Ç—É–ø.

üß† –î–æ–¥–∞—Ç–∫–æ–≤–æ:
RDP –ø—Ä–∞—Ü—é—î –Ω–∞ TCP-–ø–æ—Ä—Ç—ñ 3389

–Ø–∫—â–æ –∫–æ–º–ø‚Äô—é—Ç–µ—Ä —É –ø—É–±–ª—ñ—á–Ω—ñ–π –º–µ—Ä–µ–∂—ñ, RDP –º–æ–∂–µ –±–ª–æ–∫—É–≤–∞—Ç–∏—Å—å

–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á, –¥–æ —è–∫–æ–≥–æ —Ç–∏ –ø—ñ–¥–∫–ª—é—á–∞—î—à—Å—è, –º–∞—î –±—É—Ç–∏ —É –≥—Ä—É–ø—ñ Remote Desktop Users –∞–±–æ –±—É—Ç–∏ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º

## üõ†Ô∏è –î–æ–¥–∞—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –¥–æ –≥—Ä—É–ø–∏ RDP –¥–ª—è –¥–æ—Å—Ç—É–ø—É —á–µ—Ä–µ–∑ –≤—ñ–¥–¥–∞–ª–µ–Ω–∏–π —Ä–æ–±–æ—á–∏–π —Å—Ç—ñ–ª:
```powershell
Add-LocalGroupMember -Group "Remote Desktop Users" -Member "YourUsername"
```


### "–î–æ–∑–≤–æ–ª–∏—Ç–∏ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –ª–∏—à–µ –∑ —Ç–∏—Ö –∫–æ–º–ø‚Äô—é—Ç–µ—Ä—ñ–≤, –Ω–∞ —è–∫–∏—Ö –∑–∞–ø—É—â–µ–Ω–æ –≤—ñ–¥–¥–∞–ª–µ–Ω–∏–π —Ä–æ–±–æ—á–∏–π —Å—Ç—ñ–ª –∑ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—î—é –Ω–∞ –º–µ—Ä–µ–∂–µ–≤–æ–º—É —Ä—ñ–≤–Ω—ñ (NLA)"

–Ø–∫—â–æ —Ö–æ—á–µ—à –∑–Ω—è—Ç–∏ —ó—ó, —Ç–æ–±—Ç–æ –≤–∏–º–∫–Ω—É—Ç–∏ –æ–±–æ–≤‚Äô—è–∑–∫–æ–≤—É –º–µ—Ä–µ–∂–µ–≤—É –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—é (NLA) ‚Äî –∑—Ä–æ–±–∏ —Ü–µ —á–µ—Ä–µ–∑ PowerShell:

‚úÖ –ö–æ–º–∞–Ω–¥–∞ PowerShell:
```powershell
Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp' -Name "UserAuthentication" -Value 0
```

üîÑ –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏ —Å–ª—É–∂–±—É RDP (–æ–ø—Ü—ñ–π–Ω–æ):
```powershell
Restart-Service TermService -Force
```

## ‚ö†Ô∏è –ü—ñ—Å–ª—è —Ü—å–æ–≥–æ –∑‚Äô—î–¥–Ω–∞–Ω–Ω—è –º–æ–∂–µ –∫–æ—Ä–æ—Ç–∫–æ –ø–µ—Ä–µ—Ä–≤–∞—Ç–∏—Å—è!

–¶–µ –æ—á—ñ–∫—É–≤–∞–Ω–∞ –ø–æ–≤–µ–¥—ñ–Ω–∫–∞ —ñ –Ω–µ —î –ø–æ–º–∏–ª–∫–æ—é. –ü–µ—Ä–µ—Ä–∏–≤–∞–Ω–Ω—è –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–ª—É–∂–±–∏ RDP —ñ –∑–∞–∑–≤–∏—á–∞–π —Ç—Ä–∏–≤–∞—î –ª–∏—à–µ –∫—ñ–ª—å–∫–∞ —Å–µ–∫—É–Ω–¥.
–¶–µ –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–ª—É–∂–±–∏ RDP —ñ –∑–∞–∑–≤–∏—á–∞–π —Ç—Ä–∏–≤–∞—î –ª–∏—à–µ –∫—ñ–ª—å–∫–∞ —Å–µ–∫—É–Ω–¥.

## üß† –©–æ —Ü–µ –¥–∞—î?
–ë–µ–∑ NLA –º–æ–∂–Ω–∞ –ø—ñ–¥–∫–ª—é—á–∞—Ç–∏—Å—è –∑—ñ —Å—Ç–∞—Ä—ñ—à–∏—Ö –∫–ª—ñ—î–Ω—Ç—ñ–≤ –∞–±–æ –∑ Linux/Mac –±–µ–∑ —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω–æ—ó –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ NLA.

–¶–µ –º–µ–Ω—à –±–µ–∑–ø–µ—á–Ω–æ, –∞–ª–µ —á–∞—Å—Ç–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –¥–ª—è —Ç–µ—Å—Ç—ñ–≤ –∞–±–æ Ansible/WinRM.

![RDP](images/rdp2.png)