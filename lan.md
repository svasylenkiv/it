# üõ† –í–∏—Ä—ñ—à–µ–Ω–Ω—è –ø–æ–º–∏–ª–∫–∏ WinRM: "WinRM firewall exception will not work since one of the network connection types on this machine is set to Public"

## üîç –ü—Ä–æ–±–ª–µ–º–∞

–ü—ñ–¥ —á–∞—Å —Å–ø—Ä–æ–±–∏ –≤–≤—ñ–º–∫–Ω—É—Ç–∏ WinRM –≤–∏–Ω–∏–∫–∞—î –ø–æ–º–∏–ª–∫–∞:
"WinRM firewall exception will not work since one of the network connection types on this machine is set to Public.
Change the network connection type to either Domain or Private and try again."


**–ö–æ–¥ –ø–æ–º–∏–ª–∫–∏**: `0x80338169`

–¶–µ –æ–∑–Ω–∞—á–∞—î, —â–æ –º–µ—Ä–µ–∂–µ–≤–∏–π –ø—Ä–æ—Ñ—ñ–ª—å –≤–∞—à–æ–≥–æ –∫–æ–º–ø‚Äô—é—Ç–µ—Ä–∞ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–π —è–∫ `Public`, —ñ WinRM –Ω–µ –º–æ–∂–µ –≤–Ω–µ—Å—Ç–∏ –∑–º—ñ–Ω–∏ –≤ –±—Ä–∞–Ω–¥–º–∞—É–µ—Ä.

---

## ‚úÖ –†—ñ—à–µ–Ω–Ω—è

### –í–ê–†–Ü–ê–ù–¢ 1: –ó–º—ñ–Ω–∏—Ç–∏ –º–µ—Ä–µ–∂–µ–≤–∏–π –ø—Ä–æ—Ñ—ñ–ª—å –Ω–∞ Private —á–µ—Ä–µ–∑ PowerShell

1. –í—ñ–¥–∫—Ä–∏–π PowerShell **–≤—ñ–¥ —ñ–º–µ–Ω—ñ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞**
2. –ü–µ—Ä–µ–≤—ñ—Ä –ø–æ—Ç–æ—á–Ω—ñ –º–µ—Ä–µ–∂–µ–≤—ñ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è:

```powershell
Get-NetConnectionProfile
```
3. –ó–Ω–∞–π–¥–∏ –º–µ—Ä–µ–∂—É –∑ —Ç–∏–ø–æ–º `Public` —ñ –∑–∞–ø–∞–º‚Äô—è—Ç–∞–π —ó—ó `InterfaceIndex` –∞–±–æ `Name`.
4. –ó–º—ñ–Ω–∏ —Ç–∏–ø –º–µ—Ä–µ–∂—ñ –Ω–∞ `Private`:

```powershell
Set-NetConnectionProfile -InterfaceIndex <InterfaceIndex> -NetworkCategory Private
```
–ê–ë–û

```powershell
Set-NetConnectionProfile -Name "<Name>" -NetworkCategory Private
```
5. –ü–µ—Ä–µ–≤—ñ—Ä, —á–∏ –∑–º—ñ–Ω–∏–≤—Å—è —Ç–∏–ø –º–µ—Ä–µ–∂—ñ:

```powershell
Get-NetConnectionProfile
```
### –í–ê–†–Ü–ê–ù–¢ 2: –ó–º—ñ–Ω–∏—Ç–∏ –º–µ—Ä–µ–∂–µ–≤–∏–π –ø—Ä–æ—Ñ—ñ–ª—å –Ω–∞ Private —á–µ—Ä–µ–∑ GUI
1. –í—ñ–¥–∫—Ä–∏–π **–ü–∞—Ä–∞–º–µ—Ç—Ä–∏** (Win + I).
2. –ü–µ—Ä–µ–π–¥–∏ –¥–æ **–ú–µ—Ä–µ–∂–∞ —Ç–∞ –Ü–Ω—Ç–µ—Ä–Ω–µ—Ç**.
3. –í–∏–±–µ—Ä–∏ **Ethernet** –∞–±–æ **Wi-Fi** (–∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ —Ç–≤–æ–≥–æ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è).
4. –ö–ª–∞—Ü–Ω–∏ –Ω–∞ –Ω–∞–∑–≤—É –º–µ—Ä–µ–∂—ñ, –¥–æ —è–∫–æ—ó —Ç–∏ –ø—ñ–¥–∫–ª—é—á–µ–Ω–∏–π.
5. –ó–Ω–∞–π–¥–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä **–ü—Ä–æ—Ñ—ñ–ª—å –º–µ—Ä–µ–∂—ñ** —ñ –≤–∏–±–µ—Ä–∏ **–ü—Ä–∏–≤–∞—Ç–Ω–∞**.
### –í–ê–†–Ü–ê–ù–¢ 3: –ó–º—ñ–Ω–∏—Ç–∏ –º–µ—Ä–µ–∂–µ–≤–∏–π –ø—Ä–æ—Ñ—ñ–ª—å –Ω–∞ Private —á–µ—Ä–µ–∑ —Ä–µ—î—Å—Ç—Ä
1. –í—ñ–¥–∫—Ä–∏–π **–†–µ–¥–∞–∫—Ç–æ—Ä —Ä–µ—î—Å—Ç—Ä—É** (regedit).
2. –ü–µ—Ä–µ–π–¥—ñ—Ç—å –¥–æ –∫–ª—é—á–∞:
```
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkList\Profiles
```
3. –ó–Ω–∞–π–¥–∏ –ø—Ä–æ—Ñ—ñ–ª—å –º–µ—Ä–µ–∂—ñ, —è–∫–∏–π –º–∞—î —Ç–∏–ø `Public`.
4. –ó–º—ñ–Ω—ñ—Ç—å –∑–Ω–∞—á–µ–Ω–Ω—è `Category` –∑ `0` (Public) –Ω–∞ `1` (Private).
5. –ü–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂ –∫–æ–º–ø'—é—Ç–µ—Ä.
### –í–ê–†–Ü–ê–ù–¢ 4: –í–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ –∫–æ–º–∞–Ω–¥—É –¥–ª—è –∑–º—ñ–Ω–∏ –º–µ—Ä–µ–∂–µ–≤–æ–≥–æ –ø—Ä–æ—Ñ—ñ–ª—é
1. –í—ñ–¥–∫—Ä–∏–π **–ö–æ–º–∞–Ω–¥–Ω–∏–π —Ä—è–¥–æ–∫** –≤—ñ–¥ —ñ–º–µ–Ω—ñ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞.
2. –í–∏–∫–æ–Ω–∞–π –∫–æ–º–∞–Ω–¥—É:

```cmd
netsh interface set interface name="<Name>" newname="<NewName>" admin=enabled
```
3. –ó–∞–º—ñ–Ω–∏ `<Name>` –Ω–∞ –Ω–∞–∑–≤—É —Ç–≤–æ–≥–æ –º–µ—Ä–µ–∂–µ–≤–æ–≥–æ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É, –∞ `<NewName>` –Ω–∞ –±–∞–∂–∞–Ω–µ —ñ–º'—è.
### –í–ê–†–Ü–ê–ù–¢ 5: –í–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ –≥—Ä—É–ø–æ–≤—É –ø–æ–ª—ñ—Ç–∏–∫—É
1. –í—ñ–¥–∫—Ä–∏–π **–†–µ–¥–∞–∫—Ç–æ—Ä –≥—Ä—É–ø–æ–≤–∏—Ö –ø–æ–ª—ñ—Ç–∏–∫** (gpedit.msc).
2. –ü–µ—Ä–µ–π–¥–∏ –¥–æ **–ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è –∫–æ–º–ø'—é—Ç–µ—Ä–∞** > **–ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ñ —à–∞–±–ª–æ–Ω–∏** > **–ú–µ—Ä–µ–∂–∞** > **–ü–∞—Ä–∞–º–µ—Ç—Ä–∏ –º–µ—Ä–µ–∂—ñ**.
3. –ó–Ω–∞–π–¥–∏ –ø–æ–ª—ñ—Ç–∏–∫—É **–ó–º—ñ–Ω–∏—Ç–∏ —Ç–∏–ø –º–µ—Ä–µ–∂—ñ –Ω–∞ –ü—Ä–∏–≤–∞—Ç–Ω–∞**.
4. –í—Å—Ç–∞–Ω–æ–≤–∏ —ó—ó –≤ **–£–≤—ñ–º–∫–Ω–µ–Ω–æ**.
5. –ó–∞—Å—Ç–æ—Å—É–π –∑–º—ñ–Ω–∏ —Ç–∞ –ø–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂ –∫–æ–º–ø'—é—Ç–µ—Ä.
### –í–ê–†–Ü–ê–ù–¢ 6: –í–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ —Å—Ü–µ–Ω–∞—Ä—ñ–π PowerShell
1. –°—Ç–≤–æ—Ä–∏ —Ñ–∞–π–ª `ChangeNetworkProfile.ps1` –∑ –Ω–∞—Å—Ç—É–ø–Ω–∏–º –≤–º—ñ—Å—Ç–æ–º:

```powershell
$network = Get-NetConnectionProfile | Where-Object { $_.NetworkCategory -eq 'Public' }
if ($network) {
    Set-NetConnectionProfile -InterfaceIndex $network.InterfaceIndex -NetworkCategory Private
    Write-Host "Network profile changed to Private."
} else {
    Write-Host "No Public network profile found."
}
```